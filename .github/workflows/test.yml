name: Merge release branch into master branch

on:
  issue_comment:
    types: [created]

jobs:
  merge-release-branch:
    runs-on: ubuntu-latest
    if: github.event.issue.pull_request && contains(github.event.comment.body, '/test-release-branch-workflow')
    steps:
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      - name: Extract branch name
        id: extract_branch
        run: |
          PR_BRANCH="${{ github.event.issue.pull_request.head.ref }}"
          echo "Current branch is $PR_BRANCH"
      
      - name: Verify release branch
        id: verify_release_branch
        run: |
          echo $
          if [[ "$pr_branch" != "release/"* ]]; then
            echo "This workflow only runs for release branches. Stopping the workflow..."
            exit 1
          fi

      - name: Debug script
        run: |
          IS_PR="${{ github.event.issue.pull_request }}"
          GH_REF="${{ github.ref }}"
          COMMENT_BODY="${{ github.event.comment.body }}"
          echo Is PR $IS_PR ref $GH_REF comment body $COMMENT_BODY

